<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>5-4. ケーススタディ：小売オムニチャネル | アーキテクチャ学習ランド</title>
  <link rel="stylesheet" href="../../css/style.css">
  <link rel="stylesheet" href="../../css/components.css">
  <link rel="stylesheet" href="../../css/responsive.css">
  <style>
    .cs-memo { background: #fffef5; border: 2px solid #e6d9a8; border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0; }
    .cs-memo-title { font-weight: 700; color: #8b7a2e; margin-bottom: 1rem; font-size: 1rem; }
    .cs-memo-speaker { font-weight: 700; color: #5d4e0f; margin-top: 1rem; }
    .cs-memo p { line-height: 1.8; margin: 0.25rem 0; }
    .cs-task { background: #fff; border: 2px solid var(--phase5-color); border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0; }
    .cs-task h3 { color: var(--phase5-color); margin: 0 0 0.5rem; font-size: 1.05rem; }
    .cs-task p { margin: 0 0 1rem; font-size: 0.95rem; color: var(--text-secondary); }
    .cs-hint-btn, .cs-answer-btn { padding: 0.5rem 1.2rem; border: 2px solid var(--phase5-color); border-radius: 8px; background: #fff; color: var(--phase5-color); font-weight: 700; font-size: 0.9rem; cursor: pointer; margin-right: 0.5rem; margin-bottom: 0.5rem; font-family: inherit; transition: all 0.2s; }
    .cs-hint-btn:hover { background: #fff5f5; }
    .cs-answer-btn { background: var(--phase5-color); color: #fff; }
    .cs-answer-btn:hover { opacity: 0.9; }
    .cs-hint { display: none; margin-top: 1rem; padding: 0.75rem 1rem; background: #fff8f0; border-left: 4px solid #ffa726; border-radius: 0 8px 8px 0; font-size: 0.9rem; line-height: 1.7; }
    .cs-hint.visible { display: block; }
    .cs-answer { display: none; margin-top: 1rem; padding: 1.25rem; background: #f0f9f0; border: 2px solid #4caf50; border-radius: 12px; line-height: 1.8; }
    .cs-answer.visible { display: block; }
    .cs-answer h4 { color: #2e7d32; margin: 0 0 0.5rem; }
    .cs-answer ul { margin: 0.5rem 0; padding-left: 1.2rem; }
    .cs-info-table { font-size: 0.9rem; margin: 1rem 0; }
    .cs-info-table td { padding: 0.4rem 0.75rem; }
    .cs-info-table td:first-child { font-weight: 700; white-space: nowrap; }
  </style>
</head>
<body data-phase="5">
  <header class="site-header">
    <div class="container">
      <a href="../../index.html" class="site-logo"><span class="owl-icon">🦉</span><span>アーキテクチャ学習ランド</span></a>
      <button class="nav-toggle" aria-label="メニューを開く" aria-expanded="false">☰</button>
      <nav><ul class="nav-links">
        <li><a href="../../index.html">ホーム</a></li>
        <li><a href="../phase1/index.html">Phase 1</a></li>
        <li><a href="../phase2/index.html">Phase 2</a></li>
        <li><a href="../phase3/index.html">Phase 3</a></li>
        <li><a href="../phase4/index.html">Phase 4</a></li>
        <li><a href="index.html" class="active">Phase 5</a></li>
      </ul></nav>
    </div>
  </header>

  <main class="topic-page">
    <div class="container">
      <nav class="breadcrumb" aria-label="パンくずリスト">
        <a href="../../index.html">ホーム</a><span class="separator">/</span>
        <a href="index.html">Phase 5</a><span class="separator">/</span>
        <span class="current">5-4. ケーススタディ：小売オムニチャネル</span>
      </nav>

      <h1>5-4. ケーススタディ：大手小売チェーンのオムニチャネル</h1>

      <div class="owl-box owl-intro">
        <div class="owl-box-content">
          <p class="owl-box-title">フクロウ先生より</p>
          <p>小売業のDXといえば<strong>オムニチャネル</strong>——EC・実店舗・アプリのデータを統合して顧客体験を向上させること。セール時のアクセス集中、リアルタイム在庫連携など、<strong>スケーラビリティとパフォーマンス</strong>が最大のテーマです！</p>
        </div>
      </div>

      <section class="content-section">
        <h2>お客様情報</h2>
        <table class="cs-info-table">
          <tr><td>企業名</td><td>ブルースカイ・リテール株式会社（仮称）</td></tr>
          <tr><td>業種</td><td>総合小売チェーン（食品・日用品・衣料）</td></tr>
          <tr><td>店舗数</td><td>全国300店舗</td></tr>
          <tr><td>EC売上</td><td>年間200億円（全売上の15%、急成長中）</td></tr>
          <tr><td>アプリ会員</td><td>500万人（月間アクティブ200万人）</td></tr>
          <tr><td>IT体制</td><td>IT推進部15名＋外部ベンダー3社</td></tr>
          <tr><td>予算感</td><td>5〜8億円（2年計画）</td></tr>
        </table>
      </section>

      <section class="content-section">
        <h2>ヒアリングメモ</h2>
        <div class="cs-memo">
          <p class="cs-memo-title">初回ヒアリング議事メモ（IT推進部 山本部長）</p>

          <p class="cs-memo-speaker">山本部長：</p>
          <p>「今、ECと店舗の在庫が別管理なんです。お客様がECで見た商品が店舗にあるのかわからない。逆に店舗で品切れの商品をECから取り寄せることもできない。これを統合したいんです。」</p>

          <p class="cs-memo-speaker">山本部長：</p>
          <p>「年に4回ある大型セール期間中は、ECのアクセスが通常の20倍になります。去年のブラックフライデーでサイトが30分落ちて、推定1億円の機会損失が出ました。もう二度と繰り返したくない。」</p>

          <p class="cs-memo-speaker">山本部長：</p>
          <p>「アプリのプッシュ通知でパーソナライズしたクーポンを配信したい。お客様の購買履歴から"おすすめ商品"も出したい。データ分析基盤も合わせて整備する必要があると考えています。」</p>

          <p class="cs-memo-speaker">山本部長：</p>
          <p>「ベンダーが3社いて、ECはA社、POSはB社、アプリはC社が担当しています。これがデータ統合を難しくしている原因の一つです。全部リプレースは無理なので、うまく連携させたい。」</p>
        </div>
      </section>

      <!-- 課題1 -->
      <section class="content-section">
        <div class="cs-task" id="task1">
          <h3>課題1：推奨アーキパターンは？</h3>
          <p>3社のベンダーが担当するシステムを統合しつつ、セール時のアクセス集中にも耐えるアーキテクチャを考えてください。</p>
          <button class="cs-hint-btn" onclick="showHint('task1', 1)">ヒント 1</button>
          <button class="cs-hint-btn" onclick="showHint('task1', 2)">ヒント 2</button>
          <button class="cs-answer-btn" onclick="showAnswer('task1')">模範解答を見る</button>
          <div class="cs-hint" id="task1-hint1">3社のシステムを直接つなぐと「スパゲティ連携」になります。中央に「統合レイヤー」を置くのが定石。Phase 1のAPI連携を思い出して。</div>
          <div class="cs-hint" id="task1-hint2">セール時20倍のアクセス → オートスケールが必須。在庫のリアルタイム性 → イベント駆動で在庫変更を各システムに通知。Phase 3のディシジョンツリーでは「大規模＋機能単位スケール」。</div>
          <div class="cs-answer" id="task1-answer">
            <h4>模範解答</h4>
            <p><strong>推奨：マイクロサービス ＋ イベント駆動 ＋ BFF</strong></p>
            <ul>
              <li><strong>統合API層（API Gateway + BFF）</strong>：EC・アプリ・店舗POSからのアクセスを受け付け、バックエンドサービスを統合して返す</li>
              <li><strong>在庫サービス</strong>：全チャネル共通の在庫管理。EC/店舗の在庫をリアルタイムに統合。イベント駆動で在庫変更を各システムに即時通知</li>
              <li><strong>商品サービス</strong>：商品マスター管理。CDNで商品画像を高速配信</li>
              <li><strong>会員・レコメンドサービス</strong>：購買履歴に基づくパーソナライズ。データ分析基盤と連携</li>
              <li><strong>注文サービス</strong>：EC注文の処理。メッセージキューで非同期化し、ピーク時も安定</li>
              <li><strong>データ分析基盤</strong>：全チャネルのデータを統合してDWHに蓄積。BIダッシュボード＋レコメンドエンジン</li>
            </ul>
            <p><strong>選定理由</strong>：3社のシステムは「そのまま使い、APIで連携」がコスト効率的。中央に統合層を置き、各サービスが独立してスケール可能な構成にする。セール時はEC・注文サービスだけスケールアウトし、他のサービスは通常稼働で済む。</p>
          </div>
        </div>
      </section>

      <!-- 課題2 -->
      <section class="content-section">
        <div class="cs-task" id="task2">
          <h3>課題2：注意すべき非機能要件は？</h3>
          <p>セール時の20倍アクセスとリアルタイム在庫連携を踏まえ、重要な非機能要件を3つ挙げてください。</p>
          <button class="cs-hint-btn" onclick="showHint('task2', 1)">ヒント 1</button>
          <button class="cs-hint-btn" onclick="showHint('task2', 2)">ヒント 2</button>
          <button class="cs-answer-btn" onclick="showAnswer('task2')">模範解答を見る</button>
          <div class="cs-hint" id="task2-hint1">「20倍のアクセス」→ スケーラビリティ。「30分のダウンで1億円損失」→ 可用性。「リアルタイム在庫」→ パフォーマンスと一貫性。</div>
          <div class="cs-hint" id="task2-hint2">在庫の一貫性はどこまで求めるか？「厳密なリアルタイム」vs「数秒の遅延は許容」で構成が大きく変わります。</div>
          <div class="cs-answer" id="task2-answer">
            <h4>模範解答</h4>
            <p><strong>1. スケーラビリティ（最重要）</strong></p>
            <ul>
              <li>セール時に通常の20倍 → オートスケール必須</li>
              <li>機能単位でスケール（注文サービスだけ20倍にスケール、会員サービスは通常）</li>
              <li>CDNで静的コンテンツ（商品画像等）を配信し、サーバー負荷を軽減</li>
              <li>事前のキャパシティプランニング＋負荷テストを実施</li>
            </ul>
            <p><strong>2. 可用性（30分のダウン＝1億円損失）</strong></p>
            <ul>
              <li>SLA 99.95%以上を目標（年間4.4時間以内）</li>
              <li>複数AZ構成、DB冗長化</li>
              <li>サーキットブレーカー：1つのサービスが落ちても他は動き続ける設計</li>
              <li>セール前のリハーサル（負荷テスト）を計画に含める</li>
            </ul>
            <p><strong>3. パフォーマンス（在庫のリアルタイム性）</strong></p>
            <ul>
              <li>在庫データは「結果整合性」で設計（数秒〜十数秒の遅延は許容）</li>
              <li>在庫引当は「楽観ロック」＋購入時の最終確認で二重販売を防止</li>
              <li>在庫変更はイベント駆動で各チャネルに非同期通知</li>
              <li>商品検索はElasticsearch等でキャッシュ＆高速化</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- 課題3 -->
      <section class="content-section">
        <div class="cs-task" id="task3">
          <h3>課題3：開発チームに確認すべきことは？</h3>
          <p>3社ベンダー体制での開発リスクも踏まえ、確認すべき質問を考えてください。</p>
          <button class="cs-hint-btn" onclick="showHint('task3', 1)">ヒント 1</button>
          <button class="cs-answer-btn" onclick="showAnswer('task3')">模範解答を見る</button>
          <div class="cs-hint" id="task3-hint1">ベンダー3社の「API仕様の整合性」「責任分界点」が最大のリスク。誰がどこまで作り、障害時に誰が対応するか。</div>
          <div class="cs-answer" id="task3-answer">
            <h4>模範解答：確認すべき質問例</h4>
            <ul>
              <li><strong>「3社間のAPI仕様は誰が取りまとめますか？仕様の不整合が発生した場合の調整プロセスは？」</strong>→ マルチベンダー体制最大のリスク</li>
              <li><strong>「通常時20倍の負荷テストを実施する環境と費用は見積もりに含まれていますか？」</strong>→ 負荷テストのコストは見落とされがち</li>
              <li><strong>「在庫の"結果整合性"で問題が起きるケース（例：セール品の二重販売）の対策は？」</strong>→ 結果整合性のリスクと対策の確認</li>
              <li><strong>「セール期間中に障害が発生した場合、3社のどこが一次対応しますか？エスカレーションフローは？」</strong>→ 障害時の責任分界点の明確化</li>
              <li><strong>「現行のPOSシステム（B社）のAPI化は技術的に可能ですか？追加開発の工数は？」</strong>→ 既存システムのAPI対応可否の確認</li>
            </ul>
          </div>
        </div>
      </section>

      <div class="owl-box owl-encourage">
        <div class="owl-box-content">
          <p class="owl-box-title">フクロウ先生のまとめ</p>
          <p>小売オムニチャネルのキーワードは<strong>「統合」と「スケール」</strong>。複数チャネルのデータを統合しつつ、セール時の爆発的なアクセスに耐える。そして3社ベンダーの調整という現実的な課題もある——まさに実践力が問われるケースでした。最後はロールプレイで全スキルを試しましょう！</p>
        </div>
      </div>

      <div class="page-nav">
        <a href="03-case-study-banking.html" class="page-nav-prev">
          <span class="page-nav-label">前のトピック</span>
          <span class="page-nav-title">5-3. ケーススタディ：地方銀行API基盤</span>
        </a>
        <a href="05-roleplay.html" class="page-nav-next">
          <span class="page-nav-label">次のトピック</span>
          <span class="page-nav-title">5-5. ロールプレイ：初回提案ミーティング</span>
        </a>
      </div>
    </div>
  </main>

  <footer class="site-footer"><div class="container"><p>学習の進捗は自動保存されます 🦉</p><p>アーキテクチャ学習ランド &copy; 2025</p></div></footer>
  <script src="../../js/progress.js"></script>
  <script src="../../js/app.js"></script>
  <script>
    ProgressManager.initScrollTracking('phase5', 'case-study-retail');
    function showHint(taskId, num) { document.getElementById(taskId + '-hint' + num).classList.add('visible'); }
    function showAnswer(taskId) { document.getElementById(taskId + '-answer').classList.add('visible'); }
  </script>
</body>
</html>
